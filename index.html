<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JustStock Signup</title>
  </head>
  <body>
    <div id="root"></div>
    <script>
      // If the app is opened on /d/:code (or /ref/:code, /invite/:code),
      // normalize to /?ref=:code so the SPA can pick it up even without server rewrites.
      (function () {
        try {
          var m = (location.pathname || '').match(/\/(d|ref|invite)\/([A-Za-z0-9_-]+)/i);
          if (m && m[2]) {
            var code = m[2];
            var base = location.origin + location.pathname.replace(/\/(d|ref|invite)\/.*/, '/');
            var search = location.search;
            var params = new URLSearchParams(search);
            if (!params.get('ref') && !params.get('referral') && !params.get('referralCode') && !params.get('r')) {
              params.set('ref', code);
            }
            var newUrl = base + '?' + params.toString();
            history.replaceState(null, '', newUrl);
          }
        } catch (e) {}
      })();
    </script>
    <script type="module" src="/src/main.jsx"></script>
  </body>
  </html>
